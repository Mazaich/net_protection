# net_protection
Домашнее задание по теме "Защита сети" - Машаев Роман

Задание 1
Проведите разведку системы и определите, какие сетевые службы запущены на защищаемой системе:
sudo nmap -sA < ip-адрес >
sudo nmap -sT < ip-адрес >
sudo nmap -sS < ip-адрес >
sudo nmap -sV < ip-адрес >
По желанию можете поэкспериментировать с опциями: https://nmap.org/man/ru/man-briefoptions.html.
В качестве ответа пришлите события, которые попали в логи Suricata и Fail2Ban, прокомментируйте результат.

ОТВЕТ:

Для решения задачи в нашем конкретомн случае используем две отдельные физические машины. Одна атакующая (Kali Linux) с IP-адресом
192.168.1.217 и атакуемая (Ubuntu) c IP-адесом 192.168.1.216

Использование утилиты SURICATA:

В логах Suricata (fast.log) имеются различные предупреждения. 
1."SURICATA Applayer Detect protocol only one direction" — это означает, что Suricata обнаружил протокол только в одном направлении (например, клиент-сервер), но не в обратном. 
2.Несколько предупреждений "SURICATA HTTP unable to match response to request" — Suricata не может сопоставить ответ HTTP с запросом. Это может происходить из-за таймаутов, потери пакетов или аномалий в трафике.
3."SURICATA Applayer Mismatch protocol both directions" — Suricata обнаружил несоответствие протокола в обоих направлениях. Например, в одном направлении трафик выглядит как HTTP, а в обратном — как другой протокол.
4."SURICATA HTTP request field missing colon" — в HTTP-запросе отсутствует двоеточие в заголовке. Это указывает на неправильно сформированный HTTP-запрос.
5."SURICATA HTTP request missing protocol" — в HTTP-запросе отсутствует протокол (например, HTTP/1.1).
6."SURICATA HTTP missing Host header" — в HTTP-запросе отсутствует заголовок Host, который обязателен для HTTP/1.1.
7.Множество предупреждений "ET SCAN Possible Nmap User-Agent Observed" — это срабатывание правил Emerging Threats на сканирование с помощью Nmap. Nmap использует свой собственный User-Agent, который легко распознается.
Из IP-адресов видно, что есть два узла: 192.168.1.216 и 192.168.1.217.
192.168.1.217 инициирует соединения на 192.168.1.216 на порты 9000, 8080, 80.
Предупреждения о Nmap указывают на то, что 192.168.1.217 проводит сканирование веб-сервисов на 192.168.1.216.
Из вышеуказанного можно сделать вывод:На машине 192.168.1.217 запущено сканирование (вероятно, с помощью Nmap) веб-серверов на 192.168.1.216.При этом сканирование вызывает множество предупреждений Suricata, связанных с HTTP, потому что Nmap отправляет нестандартные или неполные HTTP-запросы для определения служб. Также есть проблемы с сопоставлением запросов и ответов, что может быть связано с особенностями сканирования. 


В логах eve.json видно несколько событий, связанных с IP-адресом 192.168.1.217, который обращается к 192.168.1.216 на различные порты (8080, 9000, 80) с использованием User-Agent, характерного для Nmap Scripting Engine:
1.Сработавшие сигнатуры:
Несколько раз сработала сигнатура ET SCAN Possible Nmap User-Agent Observed (ID 2024364). Это сигнализирует о том, что в HTTP-запросах используется User-Agent, который обычно ассоциируется с Nmap.
2.HTTP-запросы с User-Agent Nmap:
Запросы к порту 8080 на пути /HNAP1, /evox/about и другие.
Запросы к порту 9000 на пути /NmapUpperCheck1761832443, /Nmap/folder/check1761832443 и корневой путь /.
Запросы к порту 80 на пути /HNAP1, /evox/about и корневой путь /.
3.Ответы от сервера:
На некоторые запросы сервер отвечает кодом 404 (Не найдено), на некоторые 200 (Успешно).
4.Статистика:
В логах также присутствует статистика Suricata, которая показывает, что было обработано 33265 пакетов, из которых 25477 TCP и 5957 UDP.

Тaким образом вывод:
Есть признаки сканирования с IP-адреса 192.168.1.217. Использование User-Agent, характерного для Nmap, и обращение к различным портам и путям на целевом хосте 192.168.1.216 указывает на то, что, вероятно, проводится сканирование веб-сервисов с помощью инструмента Nmap (в частности, с использованием его скриптовых возможностей).
Однако стоит отметить, что сигнатура, которая сработала, имеет низкую серьезность (severity 1) и категорию "Web Application Attack", но на самом деле это скорее информационное событие, указывающее на возможное сканирование.
Есть явные признаки сканирования сети с адреса 192.168.1.217
Это типичное поведение сетевого сканера, проводящего разведку и поиск уязвимостей в сети.



